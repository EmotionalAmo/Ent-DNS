# Ent-DNS 用户体验缺口分析

**作者**: Product Don Norman
**日期**: 2026-02-20
**性质**: 以信任破坏程度为优先级排序的可操作分析

---

## 最影响用户信任的体验缺口（前 3 位）

### 第一位：客户端分组是"幻觉功能" — 信任杀手

这是目前最严重的设计失败，违反了设计最基本的契约：系统应该履行它对用户承诺的事情。

用户看到 "Client Groups" 导航项，心智模型立刻被激活："这是一个可以给不同设备设置不同规则的功能。" 他花了 10 分钟创建分组、拖拽设备、绑定规则，保存，然后 DNS 行为毫无变化。

**他不会认为是功能未实现。他会认为是自己操作错了，或者产品有 bug。** 反复尝试，再次失败，信任崩塌。

Donald Norman 称之为"执行鸿沟"——用户看到了入口（可见性），理解了意图（映射），完成了操作（反馈也有），但系统没有产生任何真实效果。这比功能不存在更糟糕：它主动消耗用户信任。

**修复方案**：在规则引擎接入分组逻辑之前，有两个选择，按工作量排序：
- 选项 A（1 天）：在分组 UI 上显示一个醒目的 Banner，明确说明"分组规则过滤功能正在开发中，目前配置将被保留，但尚不影响 DNS 解析行为。"
- 选项 B（完整实现）：完成 Phase 4 规则引擎集成（`get_client_config` 扩展），让分组真正生效。

**必须先做选项 A，再做选项 B。** 现在上线一个"看起来能用但没效果"的功能是最危险的状态。

---

### 第二位：首次部署没有引导 — 每个新用户都在黑暗中摸索

用户 `docker run` 之后登录，看到一个 Dashboard，QPS 全是零。他不知道：
- 默认密码是什么（现在强制改密保护了，但告诉用户在哪里找到初始密码仍是问题）
- 需要先订阅过滤列表，否则 DNS 可以解析但什么也不会拦截
- 需要把设备的 DNS Server 指向这台机器，否则 QPS 永远是零

**没有反馈 = 系统在用户眼中是坏掉的。** QPS 永远为 0 的 Dashboard 会让用户以为部署失败了。

**快速修复（2 天工作量）**：
- Dashboard 检测：如果 total_queries == 0 且 filter_lists_count == 0，显示一个 "Getting Started" 卡片，三步引导：设置上游 DNS、订阅过滤列表、将设备 DNS 指向本机。
- 该卡片在用户有了真实流量后自动消失。不需要做引导流程，只需要一张条件显示的卡片。

---

### 第三位：Query Log 没有分组维度 — 分析数据残缺

当用户已经在用分组管理设备时（即使分组功能完整实现之后），他打开 Query Log，会发现每条日志只有 IP 地址，没有分组标签。"192.168.1.105 发出了这个请求" — 这是哪个组的设备？是访客网络还是办公网络？无从判断。

这违反了设计的一致性原则：用户在 Client Groups 页面建立的心智模型（设备属于某个组），在 Query Log 页面完全失效。

**修复方案（后端 1 天 + 前端半天）**：Query Log 每条记录加一个 group_name 字段（JOIN 查询），前端以 badge 形式展示，高级过滤新增"按分组过滤"选项。

---

## 快速胜利（1-2 天工作量，效果最明显）

**第一优先：分组功能加免责 Banner（1 天）**
投入极小，但立刻消除最大的信任风险。这是当前最高优先级的单个动作。

**第二优先：Dashboard 零流量引导卡片（2 天）**
检测 `total_queries == 0` 时显示三步引导。这是新用户留存的关键节点，工作量小但影响每一个新用户的第一印象。

这两件事加起来，消除了前两个信任缺口，且都不需要后端工程。

---

## 不建议现在做的

**1. 完整的 Onboarding 引导流程**（3-5 天设计 + 开发）
弹窗、步骤条、跳过/继续按钮——这是精细化产品的工作。现在用户量不大，用一张 Dashboard 卡片完全可以替代，效果差不多但工作量少 80%。等产品有稳定用户量后再做。

**2. Query Log 时间段快捷过滤**
"最近 10 分钟"这类快捷按钮是锦上添花。当前高级过滤（10 种条件）已经很完善，继续叠加功能会增加界面复杂度，反而提高认知负担。

**3. 规则分组管理**（UI 中的"规则组"概念）
已经有 Rules 页面的批量操作，已经有 Client Groups 绑定规则。再加一层"规则分组"会让用户的心智模型更加混乱——他需要同时理解"客户端组"和"规则组"两个概念及其关系。

---

## 结论

优先级排序只有一条主线：**先修复破坏信任的，再增加新功能。** 分组幻觉 Banner 今天就应该上线。

**文件路径**: `/Users/emotionalamo/Developer/Ent-DNS/docs/product/ux-gap-analysis-2026-02-20.md`
